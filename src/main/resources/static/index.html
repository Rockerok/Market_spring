<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" ng-app = "my_market_front">
<head>
    <meta charset="UTF-8">
    <title>Список продуктов</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.6/angular.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ngStorage/0.3.11/ngStorage.min.js"></script>
    <script src="index.js"></script>
</head>
<body ng-app="my_market_front">
<div class="container" ng-controller="appController">

    <nav class="navbar navbar-expand-lg bg-light">
        <div class="container-fluid">
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="nav nav-tabs card-header-tabs">
                    <li class="nav-item" ng-show="!isUserLoggedIn()">
                        <form class="align-middle" ng-submit="tryToAuth()">
                            <div class="input-group input-group-sm" style="padding: 4px;">
                                <input id="navLoginField" class="form-control" ng-model="user.username" type="text"
                                       aria-describedby="inputGroup-sizing-sm" style="margin-left: 10px;">

                                <input id="navPasswordField" class="form-control" ng-model="user.password" type="password"
                                       aria-describedby="inputGroup-sizing-sm" style="margin-left: 10px;">

                                <button id="navLogInSubmit" class="btn btn-outline-warning btn-sm"
                                        style="margin-left: 10px;" type="submit">Войти
                                </button>
                            </div>
                        </form>
                    </li>
                    <li class="nav-item" ng-show="isUserLoggedIn()" style="padding: 4px;">
                        <button class="btn btn-outline-secondary btn-sm" ng-click="tryToLogout()">Выйти</button>
                    </li>
                    <li class="nav-item" style="padding: 4px;">
                        <button class="btn btn-outline-warning btn-sm" ng-click="checkAuth()">Проверка польз.</button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <h2>Главная страничка магазина</h2>
    <table class="table table-hover">
        <thead><tr><td> Id </td><td>Название</td><td>Стоимость</td><td> </td><td> </td><td> </td></tr></thead>
        <tbody>
        <tr ng-repeat="p in productsList">
            <td>{{p.id}}</td>
            <td>{{p.title}}</td>
            <td>{{p.price}}</td>
            <td><button type="button" class="btn btn-info" ng-click="addToCart(p.id)">Add to Cart</button></td>
            <td><a href = # class="btn btn-info" ng-click="showProductInfo(p.id)">Подробнее</a></td>
            <td><button type="button" class="btn btn-danger" ng-click="deleteProductById(p.id)">Delete</button></td>
        </tr>
        </tbody>
    </table>
    <th />
    <h2>Корзинка</h2>
    <table class="table table-hover">
        <thead><tr><td>Название</td><td>Количество</td><td>Цена</td><td> </td></tr></thead>
        <tbody>
        <tr ng-repeat="item in cart.items">
            <td>{{item.productTitle}}</td>
            <td>{{item.quantity}}</td>
            <td>{{item.pricePerProduct+' x '+ item.quantity+' = '+item.price}}</td>
            <td><button type="button" class="btn btn-danger" ng-click="removeFromCart(item.productId)">Удалить из корзины</button></td>
        </tr>
        <tr>
            <td>ИТОГО</td>
            <td></td>
            <td>{{cart.totalPrice}}</td>
            <td><button type="button" class="btn btn-secondary" ng-click="clearCart()">Очистить корзину</button></td>
        </tr>
        <tr></tr>
        <tr ng-show="!isUserLoggedIn()">
            <td></td>
            <td></td>
            <td></td>
            <td><button type="button" class="btn btn-info" ng-click="checkOrder()">Перейти к оформлению</button></td>
        </tr>
        </tbody>
    </table>
    <div class="container-fluid">
        <ul class="nav nav-tabs card-header-tabs">
            <li class="nav-item" ng-show="isUserLoggedIn()">
                <form class="align-middle" ng-submit="tryToAuth()">
                    <div class="input-group input-group-sm" style="padding: 4px;">
                        Укажите телефон:
                        <input class="form-control" ng-model="user.phone" type="text"
                               aria-describedby="inputGroup-sizing-sm" style="margin-left: 10px;">
                        Укажите Е-майл:
                        <input class="form-control" ng-model="user.email" type="text"
                               aria-describedby="inputGroup-sizing-sm" style="margin-left: 10px;">
                        <button class="btn btn-secondary"
                                style="margin-left: 10px;" type="submit" ng-click="createOrder()">Оформить заказ
                        </button>
                    </div>
                </form>
            </li>
        </ul>
    </div>
</div>
</body>
</html>